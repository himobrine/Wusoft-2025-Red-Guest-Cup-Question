from secret import flag

from Crypto.Util.number import getPrime
from secret import flag

def pow_mod(p, q, n):
    res = 1
    while q:
        if q & 1:
            res = (res * p) % n
        q >>= 1
        p = (p * p) % n
    return res

def gcd(a, b):
    while a != 0:
        a, b = b % a, a
    return b

def mod_1(x, n):
    x0 = x
    y0 = n
    x1 = 0
    y1 = 1
    x2 = 1
    y2 = 0
    while n != 0:
        q = x // n
        (x, n) = (n, x % n)
        (x1, x2) = ((x2 - (q * x1)), x1)
        (y1, y2) = ((y2 - (q * y1)), y1)
    if x2 < 0:
        x2 += y0
    if y2 < 0:
        y2 += x0
    return x2

if __name__ == '__main__':
    p = getPrime(2048)
    q = getPrime(2048)
    n = p * q
    OrLa = (p - 1) * (q - 1)
    while True:
        e = 65537
        if gcd(e, OrLa) == 1:
            break
        else:
            e = e - 1
    d = mod_1(e, OrLa)
    dp = d % (p - 1)
    print('dp: %d' % dp)
    print('n: %d' % n)
    print('e: %d' % e)
    C = pow_mod(int.from_bytes(flag.encode(), 'big'), e, n)
    print('c: %d\n' % C)

"""
dp: 18767589529087249889460065457420552659200643150296412930966019798665019826037993959786292166248191342009108691479133525413535032931667785865485613359065722540308922027916460092286914406198470963762760242912788459019654903491257723649597409039853841291422134242900317323793909350306644878060738162191148573908649204265416440385636786435199096912979458523373787618708283329050372667529385704465192670645886397458548033155683565922763876034982125618229672276326104170936038674252633716580673746583330253052296183003360820155615502116963659244227080292239313489312263529542980948424742598818136376335822850637133350887473
n: 612285941505726715757337358459417117615494239057802849461867469115158389476104929879172132023863649723442184127939125199193549555536421058294020084762058271730130763813501690170243655988060704002629892728810274858955059047257085369959718489826098215416395375158659039902773930382025206726445759487313370666244660115968860205946540235154957228853761353217786491424386465363059850639932666612297550459228062473590804949094664502142888445729089785349952258661632153877641637225379947458684403330650022811260628566935370009695937591730908970874401412764096251945466566690604107071425447924254751808898003899535831802807722853404794930010945578556677107383285491471460328177738035479363705013760647580566926840124310217153019866037115973682217254112694664312698646868683218353988813354002880164164085540083459937069625563788022035460659655960881700275447910304504020247798945968479007312859214861384856857630985472097315590362196718322977732819549841128094273048100627822455050612114664588639095201907755520474324853699053998881971447530763273900271129591701711744852599356798323643399185459046989111136087115027073426886072180239282312940156257048441145262551608715779033301979669477992518707174971577942743344608881776317807514256843529
e: 65537
c: 394638611694651894740444701894349324991120879459248838700216855705680093109391195123927369949798825637569049395552593312232529039196276858886637699596725457215806894561427181351073557835996770058909511846641213795382054732299038016868501463271886724915041136930520491348103348731426532255893411437164967874736327484402165275834315009241464456769534794002176918741197311527915254490257109052111445760723237339532583474249265570882280414642687199527835600075079241397176364048163454728036275147765626302310984584943173828539233686456508016597222677956832597099566907488132458469756483470153533589757146818971868745258847035117967218825052597974061654313328342874519270628652219476817167256731468238054342578351482693914834924606380730248620813543010893230455831623517511299128856322853727411552874715663897394006317428905248101517585750387436806504778543018273143491189603313403352790174075512253011164554954131667026763272578670329540149436321762540619027814257786232336894695130138605501211264731749298793091526110816501325370924722889731023859149215368982258853559774089947989137485834322875954994805363109312160227837339620153209288083578665364109357420401688672338191880121578964970547542054128606546961007981352845813360030232550
"""